<html>
	<head>
		<title>SVGTree demo</title>
		<script src="tree.js"></script>
	</head>
	<body>
		<div>
			height: 
			<select id="level" class="redraw">
				
			</select>
		</div>
		<div>
			<input id="sym" class="redraw" type="checkbox" checked>symmetrical branch splits
		</div>
		<div>
			<input id="shorter" class="redraw" type="checkbox" checked>variable length
		</div>
		<div>
			length decrease ratio: <input id="length-ratio" class="redraw" type="number" step="0.05" value="0.8">
		</div>
		<div>
			<input id="thinner" class="attribute" type="checkbox" checked>variable thickness
		</div>
		<div>
			base stroke width: <input id="thickness" class="attribute" type="number" value="2" step="0.5">
		</div>
		<div>
			min branches on split: <input id="min-child" class="redraw" value="1" type="number" step="1" min="1" max="4">
		</div>
		<div>
			max branches on split: <input id="max-child" class="redraw" value="3" type="number" step="1" min="1" max="4">
		</div>
		<button onclick="regenerateTree()">regenerate</button><br>
		<button onclick="randomize()">
			<img src="img/dice.png" style="height:20px"/>
			randomize parameters
		</button>
		<div id="tree-canvas">

		</div>
	</body>
	<script>
	function $(selector){
		return document.getElementById(selector);
	}

	var max_level = 12;

	for(var i=1; i<=max_level; i++){
		var option = document.createElement("option");
		option.value=i;
		option.innerHTML = i;
		if(i=="5")
			option.selected = true;
		$("level").appendChild(option);
	}

	var tree_canvas = new SVGTree.Canvas("#tree-canvas", 600, 600);

	function randomBool(){
		var rand = Math.random();
		return rand>0.5;
	}

	function randomize(){
		$("thinner").checked = randomBool();
		$("thickness").value = Math.floor(Math.random()*10)/10+1;
		$("sym").checked = randomBool();
		$("shorter").checked = randomBool();
		$("length-ratio").value = Math.floor(Math.random()*0.9*10000)/10000+0.3;
		$("level").value = Math.floor(9*Math.random()+2);
		regenerateTree();
	}

	function attributeChange(){
		tree_canvas.decreasing_width = $("thinner").checked;
		tree_canvas.base_stroke_width=$("thickness").value;
		tree_canvas.draw();
	}

	function regenerateTree(){
		tree_canvas.symmetrical = $("sym").checked;
		tree_canvas.decreasing_length= $("shorter").checked;
		tree_canvas.decreasing_length_ratio=$("length-ratio").value;
		tree_canvas.generateTree($("level").value);
		tree_canvas.max_children_per_branch = $("max-child").value;
		alert($("max-child").value);
		alert(tree_canvas.max_children_per_branch);
		tree_canvas.min_children_per_branch =$("min-child").value;
		attributeChange();
	}

	[].forEach.call(
	  	document.querySelectorAll('.attribute'), 
	  	function(el){
	  		console.log(el);
	    	el.onchange = function(){
	    		console.log(el.value);
	    		console.log(el.checked);
	    		attributeChange();
	    	};
	  	}
	);
	
	[].forEach.call(
	  	document.querySelectorAll('.redraw'), 
	  	function(el){
	  		console.log(el);
	    	el.onchange = function(){
	    		console.log("change");
	    		console.log(el.value);
	    		console.log(el.checked);
	    		regenerateTree();
	    	};
	  	}
	);

	regenerateTree();
	</script>
</html>
